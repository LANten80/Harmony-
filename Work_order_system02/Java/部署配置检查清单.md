# 部署配置检查清单

## 📝 部署前准备检查

### 服务器信息
- [ ] 已获取服务器公网IP地址
- [ ] 已获取服务器登录密码或SSH密钥
- [ ] 已准备好SSH客户端工具（PuTTY/WinSCP等）
- [ ] 已准备好项目文件（Java文件夹）

### 本地环境
- [ ] 本地项目可以正常编译运行
- [ ] 已准备好数据库初始化脚本（init.sql）
- [ ] 已确定数据库密码（建议使用强密码）
- [ ] 已准备好JWT密钥（至少32位随机字符串）

---

## 🔧 服务器环境检查

### 系统更新
```bash
# 执行后检查
[ ] 系统已更新到最新版本
[ ] 已安装常用工具（wget, curl, vim, git）
```

### JDK 17安装检查
```bash
java -version
# 检查项：
[ ] 版本显示为 openjdk version "17.x.x"
[ ] JAVA_HOME环境变量已配置
[ ] javac命令可用
```

### Maven安装检查
```bash
mvn -version
# 检查项：
[ ] Maven版本为 3.6+
[ ] MAVEN_HOME环境变量已配置
[ ] mvn命令可用
```

### MySQL安装检查
```bash
systemctl status mysql
# 或
systemctl status mysqld
# 检查项：
[ ] MySQL服务状态为 active (running)
[ ] MySQL已设置为开机自启
[ ] 可以使用root用户登录
```

---

## 💾 数据库配置检查

### 数据库创建检查
```sql
-- 登录MySQL后执行
SHOW DATABASES;
USE work_order_system;
SHOW TABLES;
```

**检查项：**
- [ ] 数据库 `work_order_system` 存在
- [ ] 字符集为 `utf8mb4`
- [ ] 表 `users` 存在
- [ ] 表 `tasks` 存在
- [ ] 表 `user_tokens` 存在

### 数据库用户检查
```sql
-- 在MySQL中执行
SELECT user, host FROM mysql.user WHERE user='workorder';
SHOW GRANTS FOR 'workorder'@'localhost';
```

**检查项：**
- [ ] 用户 `workorder` 已创建
- [ ] 用户有 `work_order_system` 数据库的所有权限
- [ ] 可以使用该用户登录并访问数据库

### 数据库连接测试
```bash
mysql -u workorder -p work_order_system
# 输入密码后应该能成功登录
```

**检查项：**
- [ ] 可以使用workorder用户登录
- [ ] 可以访问work_order_system数据库
- [ ] 可以执行SELECT查询

---

## 📦 项目部署检查

### 项目文件检查
```bash
ls -la /opt/work-order-system/Java/
```

**检查项：**
- [ ] 项目文件已上传到服务器
- [ ] pom.xml文件存在
- [ ] src目录结构完整
- [ ] application.yml配置文件存在

### 配置文件检查
```bash
cat /opt/work-order-system/Java/src/main/resources/application.yml
```

**必须检查的配置项：**
- [ ] `spring.datasource.username` 已修改为 `workorder`
- [ ] `spring.datasource.password` 已修改为实际数据库密码
- [ ] `jwt.secret` 已修改为安全的随机字符串（不是默认值）
- [ ] `server.port` 为 8080
- [ ] `server.servlet.context-path` 为 `/api`

### 项目编译检查
```bash
cd /opt/work-order-system/Java
mvn clean package -DskipTests
ls -lh target/*.jar
```

**检查项：**
- [ ] 编译成功，无错误
- [ ] JAR文件已生成
- [ ] JAR文件大小合理（通常几MB到几十MB）

### 运行目录检查
```bash
ls -la /opt/work-order-system/app/
ls -la /opt/work-order-system/logs/
```

**检查项：**
- [ ] app目录存在
- [ ] logs目录存在
- [ ] JAR文件已复制到app目录
- [ ] 目录权限正确

---

## 🔥 防火墙和安全组检查

### 服务器防火墙检查
```bash
# CentOS/RHEL
firewall-cmd --list-ports

# Ubuntu/Debian
ufw status numbered
```

**检查项：**
- [ ] 8080端口已开放
- [ ] 防火墙规则已生效

### 阿里云安全组检查
1. 登录阿里云控制台
2. 进入ECS实例 → 安全组 → 入方向规则

**检查项：**
- [ ] 已添加8080端口规则
- [ ] 授权策略为"允许"
- [ ] 端口范围正确（8080/8080）
- [ ] 协议类型为TCP

### 端口监听检查
```bash
netstat -tlnp | grep 8080
# 或
ss -tlnp | grep 8080
```

**检查项：**
- [ ] 8080端口正在监听
- [ ] 监听地址为 0.0.0.0:8080 或 :::8080

---

## 🚀 服务运行检查

### 服务状态检查
```bash
systemctl status work-order-system
```

**检查项：**
- [ ] 服务状态为 `active (running)`
- [ ] 服务已启用（enabled）
- [ ] 无错误信息

### 服务日志检查
```bash
journalctl -u work-order-system -n 50
```

**检查项：**
- [ ] 日志显示 "Started WorkOrderSystemApplication"
- [ ] 日志显示 "Tomcat started on port(s): 8080"
- [ ] 无数据库连接错误
- [ ] 无端口占用错误
- [ ] 无其他异常错误

### 进程检查
```bash
ps aux | grep java
```

**检查项：**
- [ ] Java进程正在运行
- [ ] 进程使用的JAR文件路径正确
- [ ] 内存使用合理

---

## 🌐 服务访问检查

### 本地测试
```bash
curl http://localhost:8080/api
# 或
curl http://127.0.0.1:8080/api
```

**检查项：**
- [ ] 可以访问服务（返回响应或错误页面，不是连接拒绝）

### 公网访问测试
在本地浏览器或使用curl：
```bash
curl http://你的服务器IP:8080/api
```

**检查项：**
- [ ] 可以通过公网IP访问服务
- [ ] 返回正确的响应（或预期的错误信息）
- [ ] 响应时间合理

### API接口测试
```bash
# 测试注册接口
curl -X POST http://你的服务器IP:8080/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{"username":"testuser","phone":"13800138000","password":"test123456"}'
```

**检查项：**
- [ ] 接口可以正常调用
- [ ] 返回JSON格式响应
- [ ] 数据库操作正常（可以注册用户）

---

## 📊 性能检查

### 系统资源检查
```bash
free -h        # 内存使用
df -h          # 磁盘使用
top            # CPU和内存实时监控
```

**检查项：**
- [ ] 内存使用率 < 80%
- [ ] 磁盘使用率 < 80%
- [ ] CPU使用率正常

### 数据库性能检查
```sql
-- 在MySQL中执行
SHOW PROCESSLIST;
SHOW STATUS LIKE 'Threads_connected';
```

**检查项：**
- [ ] 数据库连接数正常
- [ ] 无长时间运行的查询
- [ ] 连接池配置合理

---

## 🔒 安全检查

### 密码安全
- [ ] 数据库root密码已修改（不是默认密码）
- [ ] 数据库workorder用户密码为强密码
- [ ] JWT密钥已修改为随机字符串
- [ ] 服务器root密码为强密码

### 权限检查
```bash
ls -la /opt/work-order-system/app/*.jar
```

**检查项：**
- [ ] JAR文件权限合理（建议644或755）
- [ ] 敏感配置文件权限合理

### 日志安全
- [ ] 日志中不包含敏感信息（密码、密钥等）
- [ ] 生产环境已关闭SQL日志输出（show-sql: false）

---

## 🔄 备份和恢复检查

### 备份脚本检查
```bash
ls -la /opt/work-order-system/backup-db.sh
chmod +x /opt/work-order-system/backup-db.sh
/opt/work-order-system/backup-db.sh
```

**检查项：**
- [ ] 备份脚本存在
- [ ] 备份脚本有执行权限
- [ ] 备份脚本可以正常执行
- [ ] 备份文件已生成

### 定时任务检查
```bash
crontab -l
```

**检查项：**
- [ ] 已配置数据库自动备份任务（可选）
- [ ] 定时任务时间合理

---

## ✅ 最终验证清单

### 功能验证
- [ ] 用户注册功能正常
- [ ] 用户登录功能正常
- [ ] Token认证功能正常
- [ ] 工单创建功能正常
- [ ] 工单查询功能正常
- [ ] 工单更新功能正常

### 稳定性验证
- [ ] 服务可以正常启动
- [ ] 服务可以正常停止
- [ ] 服务重启后可以正常启动
- [ ] 服务器重启后服务自动启动

### 监控验证
- [ ] 可以查看服务日志
- [ ] 可以查看应用日志文件
- [ ] 可以监控服务状态
- [ ] 可以监控系统资源

---

## 📝 问题记录

如果在检查过程中发现问题，请记录：

| 问题描述 | 检查项 | 状态 | 解决方案 |
|---------|--------|------|---------|
|         |        |      |         |
|         |        |      |         |
|         |        |      |         |

---

## 🎯 部署完成确认

所有检查项完成后，请确认：

- [ ] 所有必填检查项已通过
- [ ] 服务可以正常访问
- [ ] 核心功能测试通过
- [ ] 已记录所有问题和解决方案
- [ ] 已配置监控和备份（可选）

**部署完成！** ✅

---

**检查日期：** ___________  
**检查人员：** ___________  
**服务器IP：** ___________





